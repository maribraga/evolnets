<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Validate modules from summary networks by calculating the frequency with
which pairs of nodes are placed in the same module in networks sampled across MCMC"><title>Calculate support for modules from summary networks based on modules of sampled networks — support_for_modules • evolnets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate support for modules from summary networks based on modules of sampled networks — support_for_modules"><meta property="og:description" content="Validate modules from summary networks by calculating the frequency with
which pairs of nodes are placed in the same module in networks sampled across MCMC"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">evolnets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/maribraga/evolnets/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate support for modules from summary networks based on modules of sampled networks</h1>
      <small class="dont-index">Source: <a href="https://github.com/maribraga/evolnets/blob/HEAD/R/modules.R" class="external-link"><code>R/modules.R</code></a></small>
      <div class="d-none name"><code>support_for_modules.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Validate modules from summary networks by calculating the frequency with
which pairs of nodes are placed in the same module in networks sampled across MCMC</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">support_for_modules</span><span class="op">(</span></span>
<span>  <span class="va">mod_samples</span>,</span>
<span>  <span class="va">modules_across_ages</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  edge_list <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  module_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis_text <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mod_samples</dt>
<dd><p>Data frame produced by <code><a href="modules_from_samples.html">modules_from_samples()</a></code> containing module membership
of each node for each sampled network at each time slice before the present.</p></dd>


<dt>modules_across_ages</dt>
<dd><p>Data frame containing the module information for the summary network.
A <code>list</code> object returned from <code><a href="modules_across_ages.html">modules_across_ages()</a></code> or a <code>data.frame</code> object defining the
modules in the networks. If a <code>data.frame</code> is passed, it must contain three columns:
<code>$age</code> - the age of the network,
<code>$name</code> - taxon names,
<code>$module</code> - the module the taxon was assigned to.</p></dd>


<dt>threshold</dt>
<dd><p>Minimum frequency with which two nodes are placed in the same module to consider it supported. Only pairs with frequency higher than this threshold are plotted with the color of the module from the summary network.</p></dd>


<dt>edge_list</dt>
<dd><p>Logical. Whether to return a list of edge lists or a list of matrices of pairwise frequency.</p></dd>


<dt>include_all</dt>
<dd><p>Logical. Include all nodes or only those present at the time slice?</p></dd>


<dt>colors</dt>
<dd><p>Optional. Vector of module colors in the plot.</p></dd>


<dt>module_levels</dt>
<dd><p>Optional. Order of modules in the color vector.</p></dd>


<dt>axis_text</dt>
<dd><p>Logical. Plot taxon names?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing:</p><ol><li><p><code>plot</code>: A plot of pairwise frequency with which the two nodes are placed in the same module in the ancestral network for each time slice in <code>ages</code>. Cells in the diagonal show how often a host is sampled in a network (symbionts are always present);</p></li>
<li><p><code>pairwise_membership</code>: A list of edge lists or matrices with the pairwise frequencies at each time slice;</p></li>
<li><p><code>mean_support</code>: A list of mean and geometric mean pairwise frequency for each module at each time slice.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">at_ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="posterior_at_ages.html">posterior_at_ages</a></span><span class="op">(</span><span class="va">history</span>, <span class="va">ages</span>, <span class="va">tree</span>, <span class="va">host_tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">weighted_net_50</span> <span class="op">&lt;-</span> <span class="fu">get_summary_network</span><span class="op">(</span><span class="va">at_ages</span>, pt <span class="op">=</span> <span class="fl">0.5</span>, weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">all_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="modules_across_ages.html">modules_across_ages</a></span><span class="op">(</span><span class="va">weighted_net_50</span>, <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># find modules for each sampled network</span></span></span>
<span class="r-in"><span>  <span class="va">mod_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="modules_from_samples.html">modules_from_samples</a></span><span class="op">(</span><span class="va">at_ages</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># calculate support</span></span></span>
<span class="r-in"><span>  <span class="va">support</span> <span class="op">&lt;-</span> <span class="fu">support_for_modules</span><span class="op">(</span><span class="va">mod_samples</span>, <span class="va">all_mod</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">support</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-in"><span>  <span class="va">support</span><span class="op">$</span><span class="va">means</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mariana P Braga, Wouter van der Bijl, Michael Landis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

